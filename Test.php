<?phpclass Test{        public $token = 'token';//token        function index(){            //如果相等，验证成功就返回echostr            if($this->checkSignature())            {                //返回echostr                $echostr = $_GET['echostr'];                if($echostr)                { header('content-type:text');                    echo $echostr;                    exit;                }            }        }    //检查标签    function checkSignature()    {        $signature = $_GET['signature'];        $nonce = $_GET['nonce'];        $timestamp = $_GET['timestamp'];        //把这三个参数存到一个数组里面        $tmpArr = array($timestamp,$nonce,token);        //进行字典排序        sort($tmpArr);        //把数组中的元素合并成字符串，impode()函数是用来将一个数组合并成字符串的        $tmpStr = implode($tmpArr);        //sha1加密，调用sha1函数        $tmpStr = sha1($tmpStr);        //判断加密后的字符串是否和signature相等        if($tmpStr == $signature)        {            return true;        }        return false;    }        //回复图文消息        function transmitNews($object, $newsArray)        {            if(!is_array($newsArray)){                return;            }            $itemTpl = "    <item>                            <Title><![CDATA[%s]]></Title>                            <Description><![CDATA[%s]]></Description>                            <PicUrl><![CDATA[%s]]></PicUrl>                            <Url><![CDATA[%s]]></Url>                            </item>                    ";            $item_str = "";            foreach ($newsArray as $item){                $item_str .= sprintf($itemTpl, $item['Title'], $item['Description'], $item['PicUrl'], $item['Url']);            }            $xmlTpl = "<xml>                        <ToUserName><![CDATA[%s]]></ToUserName>                        <FromUserName><![CDATA[%s]]></FromUserName>                        <CreateTime>%s</CreateTime>                        <MsgType><![CDATA[news]]></MsgType>                        <ArticleCount>%s</ArticleCount>                        <Articles>                        $item_str</Articles>                        </xml>";            $result = sprintf($xmlTpl, $object->FromUserName, $object->ToUserName, time(), count($newsArray));            return $result;        }/*if (strstr($keyword, "单图文")){$content = array();$content[] = array("Title"=>"单图文标题",  "Description"=>"单图文内容", "PicUrl"=>"http://discuz.comli.com/weixin/weather/icon/cartoon.jpg", "Url" =>"http://m.cnblogs.com/?u=txw1958");}else if (strstr($keyword, "图文") || strstr($keyword, "多图文")){    $content = array();    $content[] = array("Title"=>"多图文1标题", "Description"=>"", "PicUrl"=>"http://discuz.comli.com/weixin/weather/icon/cartoon.jpg", "Url" =>"http://m.cnblogs.com/?u=txw1958");    $content[] = array("Title"=>"多图文2标题", "Description"=>"", "PicUrl"=>"http://d.hiphotos.bdimg.com/wisegame/pic/item/f3529822720e0cf3ac9f1ada0846f21fbe09aaa3.jpg", "Url" =>"http://m.cnblogs.com/?u=txw1958");    $content[] = array("Title"=>"多图文3标题", "Description"=>"", "PicUrl"=>"http://g.hiphotos.bdimg.com/wisegame/pic/item/18cb0a46f21fbe090d338acc6a600c338644adfd.jpg", "Url" =>"http://m.cnblogs.com/?u=txw1958");}if(is_array($content)){    if (isset($content[0]['PicUrl'])){        $result = $this->transmitNews($object, $content);    }else if (isset($content['MusicUrl'])){        $result = $this->transmitMusic($object, $content);    }}else{    $result = $this->transmitText($object, $content);}*/}?>